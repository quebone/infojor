<?php
namespace Infojor\Service;

final class UserService extends MainService
{
	private $entityManager;
	
	public function __construct($entityManager) {
		$this->entityManager = $entityManager;
	}

	public function login($username, $password)
	{
		$teacher = $this->entityManager->getRepository('Infojor\\Service\\Entities\\Teacher')->findOneBy(array(
			'username'=>$username,
			'password'=>sha1($password),
			));
		return $teacher;
	}
	
	public function getTeacher($id)
	{
		$teacher = $this->entityManager->find('Infojor\\Service\\Entities\\Teacher', $id);
		return $teacher;
	}
	
	public function getCurrentTutorings($teacherid) {
		$teacher = $this->getTeacher($teacherid);
		return $teacher->getTutorings($this->entityManager, $this->getActiveCourse(), $this->getActiveTrimestre());
	}

	public function getCurrentSpecialities($teacherid) {
		$teacher = $this->getTeacher($teacherid);
		return $teacher->getSpecialities($this->entityManager, $this->getActiveCourse(), $this->getActiveTrimestre());
	}

	public function getCurrentReinforcings($teacherid) {
		$teacher = $this->getTeacher($teacherid);
		return $teacher->getReinforcings($this->entityManager, $this->getActiveCourse(), $this->getActiveTrimestre());
	}
}